imports:
    - { resource: config_dev.yml }

framework:
    test: ~
    session:
        storage_id: session.storage.mock_file
    profiler:
        collect: false

doctrine:
    dbal:
        dbname:   digideps_unit_test
        
services:
    attemptsInTimeChecker:
        class:  AppBundle\Service\BruteForce\AttemptsInTimeChecker
        arguments: [ @snc_redis.default ]
        calls:
            - [ setRedisPrefix, ["test_ac_ret_code"] ]
            # after 5 attempts in the last 10 minutes, return a different return code (activate captcha)
            - [ addTrigger, [  5, 600 ] ]
    attemptsIncrementalWaitingChecker:
        class:  AppBundle\Service\BruteForce\AttemptsIncrementalWaitingChecker
        arguments: [ @snc_redis.default ]
        calls:
            - [ setRedisPrefix, ["test_ac_exception"] ]
            # after 10 attempts, freeze for 10 minutes. used by AuthControllerTest::testBruteForceSameEmail
            - [ addFreezingRule, [  10, 600 ] ]

# during tests, display on the console the entries with priority greater than "warnings" level
monolog:
   handlers:
       main:
           type: stream
           level: warning
           
jms_serializer:
    metadata:
        cache: none
        cache: file
        debug: true
        
parameters:
    fixtures:
        deputy@example.org:
            firstname: test
            lastname: deputy
            roleName: ROLE_LAY_DEPUTY
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:
        
        admin@example.org:
            firstname: test
            lastname: admin
            roleName: ROLE_ADMIN
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:

        pa@example.org:
            firstname: test
            lastname: pa
            roleName: ROLE_PA_NAMED
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:

        pa_admin@example.org:
            firstname: test
            lastname: pa-admin
            roleName: ROLE_PA_ADMIN
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:

        pa_team_member@example.org:
            firstname: test
            lastname: pa-team-member
            roleName: ROLE_PA_TEAM_MEMBER
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:

        prof@example.org:
            firstname: test
            lastname: prof
            roleName: ROLE_PROF_NAMED
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:

        casemanager@example.org:
            firstname: test
            lastname: casemanager
            roleName: ROLE_CASE_MANAGER
            password: Abcd1234
            deputyNo:
            deputyPostcode:
            caseNumber:
            clientSurname:
            typeOfReport:
            corref:
